<!DOCTYPE html>
<html>
<head>
    <title>Religious Trends in NZ - Enhanced</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
          integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin=""/>
    
    <!-- Custom CSS -->
    <link rel="stylesheet" href="style.css"/>
    
    <!-- Chart.js for enhanced visualizations -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <div class="container">
        <header>
            <h1 id="title">Religious Trends in New Zealand</h1>
            <p class="subtitle">Enhanced with temporal database architecture</p>
        </header>
        
        <div class="controls">
            <div class="control-group">
                <label for="yearSlider">Census Year:</label>
                <input type="range" id="yearSlider" min="2006" max="2018" step="6" value="2018">
                <span id="currentYear">2018</span>
            </div>
            
            <div class="control-group">
                <label for="metricSelect">Display Metric:</label>
                <select id="metricSelect">
                    <option value="no_religion_change">Change in "No Religion" %</option>
                    <option value="christian_change">Change in "Christian" %</option>
                    <option value="total_population">Total Population</option>
                    <option value="diversity_index">Religious Diversity</option>
                </select>
            </div>
            
            <div class="control-group">
                <button id="playButton">Play Timeline</button>
                <button id="resetButton">Reset View</button>
            </div>
        </div>
        
        <div class="main-content">
            <div id="map" class="map-container"></div>
            
            <div class="info-panel">
                <div id="legend" class="legend">
                    <h4>Change in persons reporting "No religion" between 2006 and 2018</h4>
                    <div class="legend-items">
                        <div class="legend-item">
                            <i style="background:purple"></i> Up 1% or more
                        </div>
                        <div class="legend-item">
                            <i style="background:gray"></i> Between -1% to 1%
                        </div>
                        <div class="legend-item">
                            <i style="background:pink"></i> Down 1% or more
                        </div>
                    </div>
                    <div class="legend-source">
                        Source: <a href="https://www.stats.govt.nz/" target="_blank">Statistics NZ</a>
                    </div>
                </div>
                
                <div id="regionStats" class="region-stats" style="display: none;">
                    <h3>Region Details</h3>
                    <div id="regionChart">
                        <canvas id="chartCanvas" width="300" height="200"></canvas>
                    </div>
                </div>
            </div>
        </div>
        
        <div id="loading" class="loading-overlay">
            <div class="spinner"></div>
            <p>Loading religious demographics data...</p>
        </div>
    </div>

    <!-- Leaflet JS -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
            integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>
    
    <!-- jQuery for convenience -->
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    
    <!-- Main application script -->
    <script src="app.js"></script>
</body>
</html>